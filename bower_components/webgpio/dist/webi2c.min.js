"use strict";!function(){function e(e){this.init(e)}function r(e,r){this.init(e,r)}var t=function(e){this.init(e)};t.prototype={init:function(r){var t=this;this.ports=new n;var o=function(e){return parseInt(e,10)},i=function(r){return t.ports.set(r,new e(r))};Object.keys(p.CHIRIMEN.I2C_PORTS).map(o).forEach(i)},ports:null},e.prototype={init:function(e){window.WorkerOvserve.notify("i2c",{method:"i2c.open",portNumber:this.portNumber}),this.portNumber=e},portNumber:0,open:function(e){var t=this;return new Promise(function(n,o){n(new r(t.portNumber,e))})}};var n=Map;r.prototype={init:function(e,r){var t=this;this.portNumber=e,this.slaveAddress=r,window.WorkerOvserve.notify("i2c",{method:"i2c.setDeviceAddress",portNumber:this.portNumber,slaveAddress:this.slaveAddress}),window.WorkerOvserve.observe("i2c.setDeviceAddress."+this.portNumber,function(e){t.slaveDevice=e.slaveDevice})},portNumber:void 0,slaveAddress:void 0,slaveDevice:void 0,read8:function(e){var r=this;return new Promise(function(t,n){window.WorkerOvserve.notify("i2c",{method:"i2c.read",portNumber:r.portNumber,readRegistar:e,aIsOctet:!0}),window.WorkerOvserve.observe("i2c.read."+r.portNumber+"."+e,function(e){return t(e.value)})})},read16:function(e){return this.read8(e)},write8:function(e,r){var t=this;return new Promise(function(n,o){window.WorkerOvserve.notify("i2c",{method:"i2c.write",portNumber:t.portNumber,registerNumber:e,value:r,aIsOctet:!0}),window.WorkerOvserve.observe("i2c.write."+t.portNumber+"."+e,function(e){n(e.value)})})},write16:function(e,r){return this.write8(e,r)}},navigator.requestI2CAccess||(navigator.requestI2CAccess=function(){return Promise.resolve(new t)});var o=function(e){return JSON.parse(String.fromCharCode.apply(null,new Uint16Array(e)))},i=function(e){for(var r=JSON.stringify(e),t=new ArrayBuffer(2*r.length),n=new Uint16Array(t),o=0,i=r.length;i>o;o++)n[o]=r.charCodeAt(o);return n};if(window.WorkerOvserve=window.WorkerOvserve||function(){function e(){this._Map=new Map}return e.prototype.observe=function(e,r){var t=this._Map.get(e)||[];t.push(r),this._Map.set(e,t)},e.prototype.unobserve=function(e,r){var t=this._Map.get(e)||[];this._Map.set(e,t.filter(function(e){return e!==r}))},e.prototype.notify=function(e){var r=Array.prototype.slice.call(arguments,1);(this._Map.get(e)||[]).forEach(function(e,t){e.apply(null,r)})},new e}(),window.Worker){var a=function(){if(document.currentScript)return document.currentScript.src;var e=document.getElementsByTagName("script"),r=e[e.length-1];return r.src?r.src:void 0}(),s=new Worker(a.substr(0,a.lastIndexOf("/"))+"/worker.js");window.WorkerOvserve.observe("gpio",function(e){var r=i(e);s.postMessage(r.buffer,[r.buffer])}),window.WorkerOvserve.observe("i2c",function(e){var r=i(e);s.postMessage(r.buffer,[r.buffer])}),s.onmessage=function(e){var r=o(e.data);window.WorkerOvserve.notify(r.method,r)}}var p={CHIRIMEN:{PORTS:{256:{portName:"CN1.I2C2_SDA",pinName:"2"},257:{portName:"CN1.I2C2_SCL",pinName:"3"},283:{portName:"CN1.UART3_RX",pinName:"4"},284:{portName:"CN1.UART3_TX",pinName:"5"},196:{portName:"CN1.SPI0_CS",pinName:"7"},197:{portName:"CN1.SPI0_CLK",pinName:"8"},198:{portName:"CN1.SPI0_RX",pinName:"9"},199:{portName:"CN1.SPI0_TX",pinName:"10"},244:{portName:"CN1.SPI1_CS",pinName:"11"},243:{portName:"CN1.SPI1_CLK",pinName:"12"},246:{portName:"CN1.SPI1_RX",pinName:"13"},245:{portName:"CN1.SPI1_TX",pinName:"14"},163:{portName:"CN2.PWM0",pinName:"10"},253:{portName:"CN2.I2C0_SCL",pinName:"11"},252:{portName:"CN2.I2C0_SDA",pinName:"12"},193:{portName:"CN2.UART0_TX",pinName:"13"},192:{portName:"CN2.UART0_RX",pinName:"14"},353:{portName:"CN2.GPIO6_A1",pinName:"15"}},I2C_PORTS:{0:{SDA:{portName:"CN2.I2C0_SCL",pinName:"11"},SCL:{portName:"CN2.I2C0_SDA",pinName:"12"}},2:{SDA:{portName:"CN1.I2C2_SDA",pinName:"2"},SCL:{portName:"CN1.I2C2_SCL",pinName:"3"}}}}}}();